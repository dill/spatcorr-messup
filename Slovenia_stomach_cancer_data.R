# This file contains 
#   -- the Slovenian stomach cancer data, 
#   -- neighbor-pairings for municipalities
#   -- R code to construct the adjacency matrix Q that encodes neighbor 
#      pairs and is proportional to the ICAR's precision matrix
#   -- coordinates for the center of each municipality.

# Further details are given below in comments.

# Number of map regions N:  At the time of this dataset, Slovenia had 192
# municipalities.  However, the dataset has 194 map
# regions;  each of two municipalities was represented by two map regions.
# The mapping of map regions to municipalities was handled correctly in
# the papers Zadnik & Reich (2006) and Reich, Hodges, and Zadnik (2006), 
# but I can no longer identify the two 
# municipalities that are represented as two map regions, and I cannot
# identify the map regions that map to these municipalities.  For the 
# purpose of the spatial-confounding analyses in the book, that doesn't
# matter;  I ignored this problem and treated the map as having 194 regions.  

N <- 194

# Number of observed deaths from stomach cancer in each municipality (1995 to
# 2001 inclusive).  For the two
# municipalities that are split into two map regions, the observed and 
# expected numbers of deaths are identical in the two map regions (equal to 
# the number of deaths in the municipality).  

O <- c( 1, 11, 0, 10, 3, 9, 14, 14, 8, 26, 0, 20, 8, 44, 3, 0, 8, 21,
 13, 12, 1, 13, 12, 3, 13, 13, 22, 4, 18, 225, 5, 4, 11, 21, 16, 8, 2,
 0, 14, 3, 7, 19, 3, 28, 12, 3, 7, 4, 11, 1, 8, 8, 21, 15, 47, 6, 6, 10,
 9, 55, 57, 32, 9, 19, 10, 5, 12, 7, 1, 5, 18, 2, 17, 18, 11, 47, 1, 3,
 10, 7, 27, 5, 13, 12, 5, 1, 7, 2, 27, 9, 46, 5, 10, 4, 78, 6, 4, 34, 1,
 2, 5, 5, 83, 40, 9, 10, 5, 24, 22, 6, 2, 15, 6, 1, 2, 45, 2, 5, 4, 11,
 35, 34, 4, 23, 9, 47, 12, 21, 18, 13, 6, 2, 0, 405, 0, 48, 7, 4, 56, 9,
 34, 31, 7, 5, 34, 8, 13, 12, 59, 55, 5, 12, 18, 21, 39, 8, 22, 23, 16,
 12, 7, 12, 7, 59, 8, 3, 4, 15, 5, 13, 3, 19, 15, 9, 3, 15, 14, 2, 3, 7,
 22, 5, 3, 7, 16, 2, 18, 8, 18, 85, 3, 24, 24, 3)

# Number of expected deaths from stomach cancer, by internal standardization.

E <- c(4.38, 2.93, 0.77, 5.50, 5.83, 4.74, 12.21, 12.74, 3.66, 18.04,
 1.08, 11.69, 6.53, 26.10, 3.43, 2.40, 6.35, 11.02, 12.84, 7.85, 4.84,
 8.47, 8.09, 4.79, 5.35, 12.94, 16.00, 2.79, 20.48, 168.65, 3.89, 6.10,
 5.96, 16.89, 9.62, 2.82, 1.97, 2.05, 6.88, 3.12, 4.85, 20.45, 2.10,
 22.01, 9.67, 1.83, 7.90, 1.72, 6.69, 2.36, 9.52, 3.23, 17.33, 41.10,
 28.50, 6.09, 3.54, 6.14, 6.35, 29.74, 43.21, 32.77, 3.61, 9.37, 7.69,
 10.08, 12.16, 6.92, 1.06, 3.41, 22.51, 6.26, 18.74, 9.19, 10.49, 35.28,
 2.87, 1.15, 5.26, 5.79, 29.60, 4.16, 8.14, 9.87, 1.78, 3.18, 9.72,
 3.99, 18.11, 6.79, 37.25, 4.73, 12.17, 2.69, 75.41, 7.84, 4.59, 29.99,
 4.19, 7.73, 6.88, 2.01, 79.46, 26.70, 9.37, 8.66, 11.16, 14.60, 24.33,
 9.47, 3.93, 15.28, 4.34, 2.41, 6.92, 30.06, 4.92, 5.88, 6.13, 6.89,
 37.92, 27.39, 5.45, 23.13, 8.57, 31.08, 7.32, 20.38, 17.40, 10.14,
 11.51, 5.80, 1.86, 446.95, 3.54, 27.34, 6.53, 5.45, 60.66, 9.25, 27.39,
 20.85, 7.22, 3.01, 28.32, 7.46, 10.14, 10.75, 44.17, 42.27, 3.41, 14.50,
 11.72, 23.54, 31.08, 8.07, 19.76, 19.68, 28.53, 7.21, 5.50, 4.90, 1.72,
 54.20, 8.81, 6.68, 4.10, 17.18, 6.02, 9.29, 8.92, 22.45, 7.57, 7.50, 3.92,
 13.85, 21.07, 3.45, 2.40, 7.30, 23.90, 10.69, 5.84, 4.02, 14.07, 6.60, 26.81,
 7.93, 24.07, 77.12, 1.00, 22.64, 27.42, 2.27)

# The covariate SES, socioeconomic status (1999 data published by Slovenia's 
# Institute of Macroeconomic Analysis and Development).

SE <- c(1,1,2,2,1,1,1,2,1,1,2,2,3,4,2,1,2,1,3,3,3,2,2,1,2,5,3,1,3,3,3,1,3,4,
3,2,3,2,2,2,2,2,1,5,3,1,2,1,4,1,5,2,4,4,2,3,2,4,3,4,4,3,3,4,4,4,5,5,1,3,5,
5,5,2,3,5,2,5,3,2,5,3,2,4,1,3,5,5,2,2,5,5,5,1,5,5,3,4,3,4,5,2,4,2,4,4,5,4,
5,5,3,2,3,3,5,5,5,2,2,4,5,5,5,5,5,3,5,5,4,3,4,5,2,5,5,5,2,4,5,5,5,5,5,2,4,
5,3,4,4,4,5,5,5,5,4,5,5,4,5,5,5,3,5,5,5,3,4,5,4,3,4,5,3,5,4,5,5,3,4,5,3,4,
4,2,4,3,4,5,4,5,2,5,5,2)

# Center the SES measure

SEc <- (SE-mean(SE))/sd(SE)

# The next two items are the data needed to compute the adjacency matrix
# Q.  They are followed by code that uses them to compute Q.

# Number of neighbors for each region:

num <- c(3, 3, 1, 5, 4, 4, 7, 8, 3, 7, 
2, 5, 4, 7, 4, 4, 3, 4, 7, 5, 
3, 4, 4, 4, 6, 4, 12, 3, 4, 9, 
5, 7, 5, 4, 3, 3, 4, 2, 7, 4, 
7, 8, 6, 8, 5, 3, 4, 6, 2, 2, 
4, 7, 6, 3, 4, 8, 5, 7, 8, 9, 
11, 3, 5, 4, 7, 4, 7, 3, 4, 4, 
6, 4, 5, 5, 6, 6, 5, 5, 3, 4, 
6, 5, 8, 6, 1, 6, 8, 4, 6, 6, 
13, 6, 6, 2, 10, 6, 5, 8, 5, 7, 
3, 4, 6, 11, 3, 5, 5, 5, 7, 6, 
5, 5, 3, 5, 5, 5, 4, 3, 5, 4, 
7, 7, 6, 8, 6, 8, 6, 6, 4, 6, 
3, 5, 2, 13, 3, 10, 5, 4, 8, 8, 
3, 7, 6, 3, 7, 5, 3, 2, 6, 3, 
2, 8, 6, 6, 7, 4, 5, 6, 6, 5, 
3, 5, 2, 8, 3, 8, 3, 10, 6, 3, 
5, 6, 7, 5, 5, 5, 4, 4, 4, 6, 
9, 5, 5, 6, 3, 5, 4, 4, 3, 3, 
3, 2, 2, 2
)

# Define the neighbors:

adj <- c(
8, 4, 3, 
6, 5, 4, 
1, 
8, 7, 6, 2, 1, 
9, 7, 6, 2, 
7, 5, 4, 2, 
14, 13, 9, 8, 6, 5, 4, 
25, 19, 16, 14, 11, 7, 4, 1, 
13, 7, 5, 
40, 32, 28, 27, 20, 15, 12, 
16, 8, 
27, 18, 17, 15, 10, 
20, 14, 9, 7, 
37, 33, 20, 19, 13, 8, 7, 
28, 27, 12, 10, 
29, 25, 11, 8, 
30, 18, 12, 
30, 27, 17, 12, 
42, 39, 38, 37, 25, 14, 8, 
33, 32, 14, 13, 10, 
31, 26, 22, 
43, 31, 24, 21, 
45, 41, 30, 24, 
43, 41, 23, 22, 
39, 36, 29, 19, 16, 8, 
44, 34, 31, 21, 
60, 57, 48, 47, 46, 40, 30, 28, 18, 15, 12, 10, 
27, 15, 10, 
39, 36, 25, 16, 
59, 54, 53, 47, 45, 27, 23, 18, 17, 
44, 43, 26, 22, 21, 
52, 48, 42, 40, 33, 20, 10, 
42, 37, 32, 20, 14, 
56, 44, 35, 26, 
56, 49, 34, 
39, 29, 25, 
42, 33, 19, 14, 
39, 19, 
50, 42, 38, 36, 29, 25, 19, 
48, 32, 27, 10, 
65, 61, 58, 45, 43, 24, 23, 
55, 52, 50, 39, 37, 33, 32, 19, 
58, 44, 41, 31, 24, 22, 
76, 67, 58, 56, 43, 34, 31, 26, 
61, 53, 41, 30, 23, 
57, 48, 27, 
60, 59, 30, 27, 
57, 52, 46, 40, 32, 27, 
56, 35, 
42, 39, 
87, 73, 68, 62, 
63, 60, 57, 55, 48, 42, 32, 
64, 61, 59, 54, 45, 30, 
59, 53, 30, 
74, 63, 52, 42, 
82, 77, 69, 67, 49, 44, 35, 34, 
60, 52, 48, 46, 27, 
86, 76, 70, 65, 44, 43, 41, 
75, 66, 64, 60, 54, 53, 47, 30, 
83, 80, 66, 63, 59, 57, 52, 47, 27, 
112, 108, 90, 89, 79, 75, 65, 64, 53, 45, 41, 
73, 72, 51, 
80, 74, 60, 55, 52, 
75, 61, 59, 53, 
93, 89, 79, 70, 61, 58, 41, 
83, 75, 60, 59, 
96, 88, 84, 82, 76, 56, 44, 
105, 87, 51, 
91, 78, 77, 56, 
93, 86, 65, 58, 
101, 95, 92, 81, 78, 72, 
81, 73, 71, 62, 
87, 81, 72, 62, 51, 
85, 83, 80, 63, 55, 
90, 83, 66, 64, 61, 59, 
98, 96, 86, 67, 58, 44, 
97, 91, 82, 69, 56, 
95, 92, 91, 71, 69, 
89, 65, 61, 
83, 74, 63, 60, 
101, 95, 87, 73, 72, 71, 
97, 84, 77, 67, 56, 
102, 94, 90, 80, 75, 74, 66, 60, 
100, 99, 97, 88, 82, 67, 
74, 
103, 98, 93, 76, 70, 58, 
110, 109, 105, 95, 81, 73, 68, 51, 
100, 96, 84, 67, 
112, 104, 93, 79, 65, 61, 
113, 108, 102, 83, 75, 61, 
127, 122, 121, 120, 117, 111, 106, 99, 97, 92, 78, 77, 69, 
107, 106, 95, 91, 78, 71, 
104, 103, 89, 86, 70, 65, 
102, 83, 
128, 116, 110, 107, 101, 92, 87, 81, 78, 71, 
115, 100, 98, 88, 76, 67, 
99, 91, 84, 82, 77, 
129, 126, 124, 115, 103, 96, 86, 76, 
111, 100, 97, 91, 84, 
115, 114, 111, 99, 96, 88, 84, 
95, 81, 71, 
113, 94, 90, 83, 
124, 118, 104, 98, 93, 86, 
149, 145, 137, 133, 124, 119, 118, 112, 103, 93, 89, 
109, 87, 68, 
123, 117, 107, 92, 91, 
128, 123, 106, 95, 92, 
119, 113, 112, 90, 61, 
142, 139, 131, 125, 110, 105, 87, 
130, 125, 116, 109, 95, 87, 
122, 114, 100, 99, 91, 
119, 108, 104, 89, 61, 
108, 102, 90, 
126, 122, 115, 111, 100, 
126, 114, 100, 98, 96, 
140, 130, 128, 110, 95, 
127, 123, 106, 91, 
124, 104, 103, 
144, 137, 112, 108, 104, 
132, 122, 121, 91, 
138, 135, 134, 132, 127, 120, 91, 
136, 132, 126, 120, 114, 111, 91, 
134, 128, 127, 117, 107, 106, 
145, 143, 133, 129, 118, 104, 103, 98, 
147, 146, 142, 130, 110, 109, 
143, 141, 136, 129, 122, 115, 114, 98, 
135, 134, 123, 121, 117, 91, 
140, 134, 123, 116, 107, 95, 
143, 126, 124, 98, 
152, 146, 140, 125, 116, 110, 
148, 139, 109, 
138, 136, 122, 121, 120, 
124, 104, 
160, 158, 157, 156, 153, 140, 138, 136, 135, 128, 127, 123, 121, 
134, 127, 121, 
158, 155, 145, 143, 141, 138, 134, 132, 126, 122, 
150, 149, 144, 119, 104, 
136, 134, 132, 121, 
174, 165, 163, 159, 148, 142, 131, 109, 
154, 153, 152, 151, 134, 130, 128, 116, 
143, 136, 126, 
159, 152, 147, 146, 139, 125, 109, 
145, 141, 136, 129, 126, 124, 
150, 137, 119, 
162, 155, 149, 143, 136, 124, 104, 
152, 147, 142, 130, 125, 
146, 142, 125, 
139, 131, 
170, 162, 150, 145, 137, 104, 
149, 144, 137, 
154, 140, 
172, 168, 159, 154, 146, 142, 140, 130, 
168, 161, 160, 154, 140, 134, 
168, 161, 153, 152, 151, 140, 
173, 167, 164, 162, 158, 145, 136, 
166, 160, 157, 134, 
169, 166, 158, 156, 134, 
173, 169, 157, 155, 136, 134, 
174, 172, 171, 152, 142, 139, 
168, 166, 156, 153, 134, 
168, 154, 153, 
170, 164, 155, 149, 145, 
165, 139, 
186, 185, 179, 173, 170, 167, 162, 155, 
174, 163, 139, 
178, 176, 175, 169, 168, 160, 157, 156, 
173, 164, 155, 
183, 182, 175, 172, 166, 161, 160, 154, 153, 152, 
181, 176, 173, 166, 158, 157, 
164, 162, 149, 
180, 177, 174, 172, 159, 
182, 180, 171, 168, 159, 152, 
181, 179, 169, 167, 164, 158, 155, 
177, 171, 165, 159, 139, 
184, 183, 178, 168, 166, 
184, 181, 178, 169, 166, 
188, 180, 174, 171, 
184, 176, 175, 166, 
186, 181, 173, 164, 
188, 187, 182, 177, 172, 171, 
194, 191, 189, 186, 184, 179, 176, 173, 169, 
187, 183, 180, 172, 168, 
187, 184, 182, 175, 168, 
191, 183, 181, 178, 176, 175, 
189, 186, 164, 
189, 185, 181, 179, 164, 
188, 183, 182, 180, 
190, 187, 180, 177, 
186, 185, 181, 
193, 192, 188, 
194, 184, 181, 
193, 190, 
192, 190, 
191, 181
)

# Compute the adjacency matrix Q.

Q <- diag(num)
count <- 1
for(i in 1:N){for(j in 1:num[i]){Q[i,adj[count]] <- -1; count <- count+1}}


# Municipality centers (X1,X2).  We had a list of points that 
# define the borders of each map region.  For each map region, X1 is the 
# mean of the range (.5[max+min]) of its x-values, and X2 is the mean 
# of the range of its y-values.  I don't know what the units are, but 
# for my purposes it doesn't matter.

X1<-c(595291.2, 583966.4, 601103.3, 591793.1, 578619.2, 583949.1, 586615.4, 
597825.8, 578612.4, 569979.9, 606742.0, 554936.5, 583179.5, 589742.4, 
564659.6, 603589.8, 546512.0, 554574.0, 594091.6, 580937.4, 510792.9, 
519345.7, 536956.7, 527914.8, 601207.1, 502220.3, 565322.8, 568766.1, 
612537.3, 549775.1, 512554.3, 579074.9, 586353.1, 496485.0, 491972.5, 
604739.4, 589549.0, 598043.9, 599437.1, 572668.6, 529833.0, 587801.6, 
520071.9, 506076.8, 537178.0, 568508.4, 559075.0, 574109.4, 489648.0, 
598279.7, 411566.4, 575241.2, 548242.5, 554640.5, 589282.6, 486573.0, 
567887.1, 517693.5, 558980.4, 566475.4, 540754.5, 428924.0, 576099.5, 
549120.8, 528537.0, 564176.5, 499304.0, 393975.8, 474141.9, 522832.4, 
449466.1, 437135.5, 423368.5, 577699.7, 557590.0, 510731.8, 479222.6, 
460617.5, 534721.8, 572960.4, 438033.5, 487975.8, 568241.0, 495527.2, 
580914.0, 517824.5, 419707.0, 502630.5, 535412.5, 557347.0, 479722.0, 
458719.5, 524023.8, 566970.0, 445853.1, 506878.0, 483969.6, 512796.2, 
493651.8, 502546.2, 446360.5, 562705.5, 522055.8, 533798.2, 389050.3, 
462315.5, 455839.2, 550065.0, 408835.9, 432202.6, 496304.5, 540396.7, 
557232.0, 501004.5, 507382.5, 444651.5, 464995.2, 525049.6, 545285.0, 
482825.0, 471734.5, 494366.5, 461647.0, 519200.0, 421486.1, 503839.1, 
465838.0, 453848.3, 509904.3, 432587.5, 396006.3, 481896.5, 531285.5, 
468031.2, 465728.0, 493073.0, 543318.0, 475013.5, 402672.6, 447381.2, 
503152.6, 422958.9, 512080.3, 551410.0, 520201.8, 431288.5, 426401.5, 
388391.1, 535428.5, 547756.5, 445281.0, 438306.4, 455944.8, 446041.0, 
503859.2, 467340.0, 474740.9, 486021.6, 417435.6, 463066.0, 452065.5, 
522616.9, 395555.6, 514733.5, 395285.0, 468523.0, 506772.0, 452207.8, 
478730.0, 525972.2, 421160.2, 436909.8, 495794.0, 403368.0, 462104.7, 
477133.8, 411265.5, 470406.6, 503549.9, 423774.2, 492939.1, 442057.0, 
459463.7, 472053.2, 524235.8, 512187.2, 445429.4, 422312.0, 517538.2, 
409376.7, 480089.7, 395284.0, 393920.7, 490585.7)

X2<-c(187422.17, 189030.66, 188358.62, 184619.85, 184269.80, 184003.60, 
179664.75, 174931.80, 177062.44, 168173.47, 171769.00, 169809.50, 
168802.80, 167928.60, 168124.10, 168338.72, 166564.35, 164012.50, 
163424.57, 164579.30, 164645.97, 160714.80, 161222.50, 159956.27, 
164270.95, 160814.95, 158935.00, 163717.10, 157328.06, 158294.00, 
157884.35, 158046.70, 158708.37, 156043.00, 156772.00, 160228.45, 
160549.20, 160913.20, 158332.50, 157744.15, 153434.00, 153826.45, 
153802.52, 149836.50, 152906.50, 153938.00, 151989.00, 153138.90, 
152922.50, 153530.10, 145843.50, 149242.20, 149762.00, 149630.00, 
144991.37, 146753.50, 148695.50, 144799.50, 147066.00, 144506.00, 
138069.50, 145067.50, 146066.50, 145015.43, 140357.50, 142099.00, 
139811.50, 135662.55, 139960.05, 140204.31, 137573.50, 140596.50, 
136293.91, 137056.75, 139608.00, 136730.50, 134782.85, 138172.00, 
138458.50, 138998.00, 133724.50, 135866.75, 133610.00, 133909.60, 
136063.50, 134327.65, 129286.50, 132860.50, 131296.58, 130423.00, 
125737.95, 131284.00, 130054.65, 130500.00, 123523.00, 128760.50, 
128022.55, 124125.50, 126914.80, 126258.00, 127256.00, 127422.00, 
123441.25, 116142.50, 123100.60, 123559.10, 121860.20, 121705.00, 
111788.80, 119750.30, 121080.75, 119342.00, 121767.00, 120030.00, 
119659.50, 114102.00, 118222.45, 117162.70, 110400.00, 114570.00, 
111881.00, 111670.05, 114205.00, 109347.05, 109439.65, 110299.60, 
113343.90, 110230.16, 110103.25, 107513.00, 105310.50, 109770.00, 
110146.40, 101897.00, 109364.55, 100617.73, 102448.00, 105883.00, 
92580.25, 101956.00, 103944.95, 93738.44, 101717.90, 101888.00, 
96080.73, 100405.50, 103135.00, 97931.27, 87570.00, 88377.50, 
97536.00, 88970.75, 89474.50, 89543.00, 87333.50, 90363.00, 
88937.80, 84463.75, 85968.96, 87803.00, 85413.14, 85574.52, 
86846.52, 73483.73, 80416.11, 78524.50, 78891.00, 72881.96,
75039.02, 75700.50, 75703.66, 72115.25, 73666.50, 75808.43, 
71545.99, 64975.45, 65253.50, 67918.26, 63406.25, 60640.00, 
54066.28, 60803.00, 57913.54, 57658.14, 56135.26, 56464.53, 
48294.30, 46958.00, 42354.26, 42142.80, 45198.68, 41538.29, 
39620.15, 39494.01)

